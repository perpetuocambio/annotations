<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red Interactiva de Conflictos Globales</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #1a1a2e;
            color: white;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #e94560;
            margin-bottom: 10px;
        }
        
        .controls {
            text-align: center;
            margin-bottom: 20px;
            background: #16213e;
            padding: 15px;
            border-radius: 8px;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            border: 2px solid #fff;
        }
        
        #network {
            border: 2px solid #0f4c75;
            border-radius: 8px;
            background: #0f1419;
        }
        
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            max-width: 200px;
            pointer-events: none;
            border: 1px solid #e94560;
        }
        
        /* Estilos para sección explicaciones */
        .explanations-section {
            margin-top: 40px;
            padding: 20px;
            background: #16213e;
            border-radius: 12px;
        }
        
        .explanations-section h2 {
            color: #e94560;
            text-align: center;
            margin-bottom: 30px;
            font-size: 28px;
        }
        
        .category-section {
            margin-bottom: 40px;
        }
        
        .category-section h3 {
            color: #74b9ff;
            margin-bottom: 20px;
            font-size: 22px;
            border-bottom: 2px solid #74b9ff;
            padding-bottom: 8px;
        }
        
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
        }
        
        .connection-card {
            background: #0f1419;
            border-radius: 8px;
            padding: 20px;
            border: 2px solid;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .connection-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(233, 69, 96, 0.3);
        }
        
        .connection-card.historical {
            border-color: #8e44ad;
        }
        
        .connection-card.proxy {
            border-color: #e74c3c;
        }
        
        .connection-card.industry {
            border-color: #fdcb6e;
        }
        
        .connection-card.indirect {
            border-color: #f39c12;
        }
        
        .connection-card h4 {
            color: #e94560;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .connection-card h5 {
            color: #74b9ff;
            margin: 10px 0 5px 0;
            font-size: 16px;
        }
        
        .timeline {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
        }
        
        .timeline-item {
            display: flex;
            margin-bottom: 10px;
            align-items: flex-start;
        }
        
        .timeline-item .year {
            background: #e94560;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            min-width: 80px;
            text-align: center;
            margin-right: 10px;
        }
        
        .timeline-item .desc {
            flex: 1;
            font-size: 14px;
        }
        
        .double-game {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 15px 0;
        }
        
        .side {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
        }
        
        .qatar-roles .role {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 10px;
        }
        
        .iran-proxies {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .proxy-group {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #e74c3c;
        }
        
        .arms-trade {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .exporter {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #fdcb6e;
        }
        
        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .resource {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #00b894;
        }
        
        .refugee-flows .flow {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 10px;
            border-left: 4px solid #f39c12;
        }
        
        .humanitarian-politics {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
        }
        
        .connection-card ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .connection-card li {
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .connection-card p {
            margin: 10px 0;
            line-height: 1.5;
            font-size: 14px;
        }
        
        .node-label {
            font-size: 10px;
            fill: white;
            text-anchor: middle;
            pointer-events: none;
            font-weight: bold;
        }
        
        button {
            background: #e94560;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 5px;
        }
        
        button:hover {
            background: #c73650;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Red Global de Conflictos Armados y Sus Conexiones</h1>
        
        <div class="controls">
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: #ff6b6b;"></div>
                    <span>Conflictos</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #0984e3;"></div>
                    <span>Superpotencias</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #74b9ff;"></div>
                    <span>Potencias Regionales</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #00b894;"></div>
                    <span>Países Secundarios</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #fdcb6e;"></div>
                    <span>Industrias</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #a29bfe;"></div>
                    <span>Organizaciones</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #636e72;"></div>
                    <span>Grupos Armados</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #8e44ad;"></div>
                    <span>Conexiones Históricas</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #27ae60;"></div>
                    <span>Conexiones Actuales</span>
                </div>
            </div>
            <button onclick="resetZoom()">Reiniciar Vista</button>
            <button onclick="pauseSimulation()">Pausar/Reanudar</button>
        </div>
        
        <svg id="network" width="100%" height="800"></svg>
        
        <!-- Sección de Cards Explicativas -->
        <div class="explanations-section">
            <h2>Análisis Detallado de Conexiones</h2>
            
            <!-- Cards por categorías -->
            <div class="category-section">
                <h3>🔴 Conexiones Paradójicas: De Aliados a Enemigos</h3>
                <div class="cards-grid">
                    <div class="connection-card historical">
                        <h4>🇺🇸 EEUU ↔️ 🏴 Talibanes</h4>
                        <div class="timeline">
                            <div class="timeline-item">
                                <span class="year">1980s</span>
                                <span class="desc">EEUU financia y entrena muyahidines (incluidos futuros talibanes) contra URSS vía Pakistán. Operación Ciclón: $3 mil millones.</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">1996-2001</span>
                                <span class="desc">Talibanes toman poder. EEUU mantiene relaciones pragmáticas por oleoductos.</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">2001-2021</span>
                                <span class="desc">Guerra total. EEUU invade tras 11-S. $2.3 billones gastados, 170,000+ muertes.</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">2018-2021</span>
                                <span class="desc">Negociaciones directas Doha. EEUU reconoce talibanes como interlocutor legítimo.</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">2021-presente</span>
                                <span class="desc">Victoria Taliban. EEUU mantiene contactos por terrorismo y ayuda humanitaria.</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="connection-card historical">
                        <h4>🇺🇸 EEUU → 🏴 ISIS (Consecuencia No Intencionada)</h4>
                        <p><strong>Cadena causal:</strong></p>
                        <ul>
                            <li><strong>2003:</strong> Invasión Irak destruye Estado iraquí</li>
                            <li><strong>2003-2006:</strong> Desmantelamiento ejército iraquí crea insurgencia</li>
                            <li><strong>2004:</strong> Surge "Al-Qaeda en Irak" liderado por Al-Zarqawi</li>
                            <li><strong>2006-2013:</strong> Evoluciona a "Estado Islámico de Irak"</li>
                            <li><strong>2013:</strong> Se expande a Siria = ISIS</li>
                            <li><strong>2014:</strong> Declara "Califato" en territorio iraquí-sirio</li>
                        </ul>
                        <p><strong>Ironía:</strong> EEUU crea la coalición anti-ISIS para combatir lo que indirectamente ayudó a crear.</p>
                    </div>
                </div>
            </div>
            
            <div class="category-section">
                <h3>🎭 El Juego Doble: Aliados que Apoyan Enemigos</h3>
                <div class="cards-grid">
                    <div class="connection-card proxy">
                        <h4>🇵🇰 Pakistán: Aliado EEUU que Apoya Talibanes</h4>
                        <div class="double-game">
                            <div class="side">
                                <h5>🤝 Como Aliado EEUU:</h5>
                                <ul>
                                    <li>$33 mil millones ayuda militar 2002-2017</li>
                                    <li>Operaciones antiterroristas conjuntas</li>
                                    <li>Bases para drones estadounidenses</li>
                                    <li>Captura líderes Al-Qaeda (incluido KSM)</li>
                                </ul>
                            </div>
                            <div class="side">
                                <h5>🤫 Como Apoyo Taliban:</h5>
                                <ul>
                                    <li>ISI entrena y financia talibanes</li>
                                    <li>Refugio seguro en áreas tribales</li>
                                    <li>Hospitales para heridos taliban</li>
                                    <li>"Profundidad estratégica" vs India</li>
                                </ul>
                            </div>
                        </div>
                        <p><strong>Resultado:</strong> Pakistán cobra por ayudar a EEUU mientras asegura que EEUU no pueda ganar.</p>
                    </div>
                    
                    <div class="connection-card proxy">
                        <h4>🇶🇦 Qatar: El Mediador Financiador</h4>
                        <div class="qatar-roles">
                            <div class="role">
                                <h5>💰 Financia Hamas:</h5>
                                <p>$1.1 mil millones transferidos a Gaza 2012-2021. Salarios funcionarios, combustible, proyectos infraestructura.</p>
                            </div>
                            <div class="role">
                                <h5>🏢 Hospeda Oficina Taliban:</h5>
                                <p>Oficina política Taliban en Doha desde 2013. Negociaciones directas EEUU-Taliban.</p>
                            </div>
                            <div class="role">
                                <h5>🛡️ Base Militar EEUU:</h5>
                                <p>Base Aérea Al Udeid: 11,000 soldados estadounidenses. Centro operaciones regionales.</p>
                            </div>
                        </div>
                        <p><strong>Paradoja:</strong> Qatar financia enemigos de Israel mientras aloja bases que protegen Israel.</p>
                    </div>
                </div>
            </div>
            
            <div class="category-section">
                <h3>🕸️ El Eje de Resistencia Iraní</h3>
                <div class="cards-grid">
                    <div class="connection-card proxy">
                        <h4>🇮🇷 Irán: Arquitecto de Red Proxy</h4>
                        <div class="iran-proxies">
                            <div class="proxy-group">
                                <h5>🇱🇧 Hezbollah (Líbano)</h5>
                                <ul>
                                    <li><strong>Presupuesto:</strong> $700M anuales</li>
                                    <li><strong>Arsenal:</strong> 130,000+ cohetes/misiles</li>
                                    <li><strong>Combatientes:</strong> 20,000+ activos</li>
                                    <li><strong>Rol:</strong> Partido dominante + milicia</li>
                                </ul>
                            </div>
                            <div class="proxy-group">
                                <h5>🏴 Hamas (Gaza)</h5>
                                <ul>
                                    <li><strong>Apoyo:</strong> $100M+ anuales</li>
                                    <li><strong>Entrenamiento:</strong> Comandos en Irán</li>
                                    <li><strong>Armas:</strong> Transferencia vía túneles</li>
                                    <li><strong>Coordinación:</strong> Ataques sincronizados</li>
                                </ul>
                            </div>
                            <div class="proxy-group">
                                <h5>🏴 Hutíes (Yemen)</h5>
                                <ul>
                                    <li><strong>Armas:</strong> Misiles balísticos avanzados</li>
                                    <li><strong>Asesores:</strong> IRGC y Hezbollah</li>
                                    <li><strong>Objetivo:</strong> Presión sobre Arabia Saudí</li>
                                    <li><strong>Bloqueo:</strong> Estrecho Bab el-Mandab</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="category-section">
                <h3>💰 Complejo Militar-Industrial Global</h3>
                <div class="cards-grid">
                    <div class="connection-card industry">
                        <h4>🏭 Industria Armamentística: Los Verdaderos Ganadores</h4>
                        <div class="arms-trade">
                            <div class="exporter">
                                <h5>🇺🇸 Estados Unidos (39% global)</h5>
                                <ul>
                                    <li>Lockheed Martin, Boeing, Raytheon</li>
                                    <li>Principales clientes: Arabia Saudí, Israel</li>
                                    <li>Yemen: $54.6B armas a coalición saudí</li>
                                </ul>
                            </div>
                            <div class="exporter">
                                <h5>🇷🇺 Rusia (20% global)</h5>
                                <ul>
                                    <li>Rosoboronexport, Kalashnikov</li>
                                    <li>Principales clientes: India, China, Siria</li>
                                    <li>Siria: Sistemas S-400, jets Su-30</li>
                                </ul>
                            </div>
                            <div class="exporter">
                                <h5>🇫🇷 Francia (8% global)</h5>
                                <ul>
                                    <li>Dassault, Thales, Naval Group</li>
                                    <li>Yemen: Jets Mirage a EAU</li>
                                    <li>África: Justifica intervención = ventas</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="connection-card industry">
                        <h4>⛽ Recursos Naturales como Motor de Conflicto</h4>
                        <div class="resources-grid">
                            <div class="resource">
                                <h5>🛢️ Petróleo - Irak/Siria</h5>
                                <p>China obtiene contratos petroleros post-guerra. ISIS vendió petróleo $500M via Turquía.</p>
                            </div>
                            <div class="resource">
                                <h5>🥇 Oro - Sudán</h5>
                                <p>EAU apoya RSF para acceder minas oro. 90+ toneladas exportadas ilegalmente.</p>
                            </div>
                            <div class="resource">
                                <h5>🔋 Litio - Afganistán</h5>
                                <p>China negocia con Taliban acceso $1 billón reservas minerales.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="category-section">
                <h3>🌊 Crisis Humanitarias como Herramientas Geopolíticas</h3>
                <div class="cards-grid">
                    <div class="connection-card indirect">
                        <h4>👥 Refugiados como Arma Diplomática</h4>
                        <div class="refugee-flows">
                            <div class="flow">
                                <h5>🇸🇾 Siria → 🇹🇷 Turquía</h5>
                                <p><strong>3.6M refugiados sirios.</strong> Turquía usa como palanca sobre UE: "€6 mil millones o abro fronteras"</p>
                            </div>
                            <div class="flow">
                                <h5>🇸🇩 Sudán → 🇹🇩 Chad</h5>
                                <p><strong>1.2M refugiados.</strong> Chad recibe fondos internacionales, Francia mantiene influencia regional.</p>
                            </div>
                            <div class="flow">
                                <h5>🇦🇫 Afganistán → 🇵🇰 Pakistán</h5>
                                <p><strong>3M+ refugiados históricos.</strong> Pakistán recibe ayuda internacional, justifica políticas pro-Taliban.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="connection-card indirect">
                        <h4>🏥 Ayuda Humanitaria = Influencia Política</h4>
                        <div class="humanitarian-politics">
                            <p><strong>Patrón global:</strong> Países crean crisis → ofrecen ayuda humanitaria → ganan influencia</p>
                            <ul>
                                <li><strong>Arabia Saudí:</strong> Destruye Yemen, dona $500M ayuda humanitaria</li>
                                <li><strong>Turquía:</strong> Interviene Siria, aloja refugiados, gana € de UE</li>
                                <li><strong>Francia:</strong> Interviene Sahel, "protege" civiles, mantiene influencia</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuración del SVG
        const svg = d3.select("#network");
        const width = window.innerWidth - 40;
        const height = 800;
        svg.attr("width", width).attr("height", height);
        
        const g = svg.append("g");
        
        // Configuración del zoom
        const zoom = d3.zoom()
            .scaleExtent([0.3, 3])
            .on("zoom", (event) => {
                g.attr("transform", event.transform);
            });
        
        svg.call(zoom);
        
        // Tooltip
        const tooltip = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);

        // Datos de la red
        const nodes = [
            // Conflictos
            {id: "PI", name: "Palestina-Israel", type: "conflict", casualties: "150,000+", description: "Conflicto más largo activo desde 1948"},
            {id: "SY", name: "Siria", type: "conflict", casualties: "656,493", description: "Guerra civil con múltiples actores internacionales"},
            {id: "YE", name: "Yemen", type: "conflict", casualties: "400,000+", description: "Peor crisis humanitaria mundial"},
            {id: "AF", name: "Afganistán", type: "conflict", casualties: "212,191", description: "Guerra más larga de EEUU (2001-2021)"},
            {id: "IQ", name: "Irak", type: "conflict", casualties: "300,000-500,000", description: "Invasión EEUU 2003, surgimiento ISIS"},
            {id: "SD", name: "Sudán", type: "conflict", casualties: "150,000", description: "Guerra civil actual desde 2023"},
            {id: "NG", name: "Nigeria/Boko Haram", type: "conflict", casualties: "35,000+", description: "Insurgencia islamista en África Occidental"},
            
            // Superpotencias
            {id: "US", name: "Estados Unidos", type: "superpower", role: "Hegemon global, principal exportador armas"},
            {id: "RU", name: "Rusia", type: "superpower", role: "Potencia revisionista, exportador armas"},
            {id: "CN", name: "China", type: "superpower", role: "Potencia emergente, reconstrucción post-conflicto"},
            
            // Potencias Regionales
            {id: "SA", name: "Arabia Saudí", type: "regional", role: "Hegemon regional Golfo, intervención Yemen"},
            {id: "IR", name: "Irán", type: "regional", role: "Eje de resistencia, influencia chiíe"},
            {id: "TR", name: "Turquía", type: "regional", role: "Potencia neo-otomana, intervención Siria"},
            {id: "UAE", name: "Emiratos", type: "regional", role: "Proyección poder, intervención Yemen/Sudán"},
            {id: "EG", name: "Egipto", type: "regional", role: "Estabilidad regional, aliado EEUU"},
            {id: "PK", name: "Pakistán", type: "regional", role: "Profundidad estratégica Afganistán"},
            {id: "IL", name: "Israel", type: "regional", role: "Aliado estratégico EEUU, ocupación Palestina"},
            
            // Países Secundarios
            {id: "JO", name: "Jordania", type: "secondary", role: "Estabilidad, campos refugiados"},
            {id: "DE", name: "Alemania", type: "secondary", role: "Apoyo basado en culpa histórica"},
            {id: "UK", name: "Reino Unido", type: "secondary", role: "Socio EEUU, exportador armas"},
            {id: "FR", name: "Francia", type: "secondary", role: "Intervención África, exportador armas"},
            {id: "TD", name: "Chad", type: "secondary", role: "Refugiados Sudán y Nigeria"},
            {id: "OM", name: "Omán", type: "secondary", role: "Mediación Yemen"},
            {id: "QA", name: "Qatar", type: "secondary", role: "Financiación Hamas, mediación Taliban"},
            {id: "LB", name: "Líbano", type: "secondary", role: "Base Hezbollah, influencia Irán"},
            {id: "SY_STATE", name: "Siria (Estado)", type: "secondary", role: "Régimen Assad, apoyo Rusia/Irán"},
            
            // Industrias
            {id: "ARMS", name: "Industria Armamentística", type: "industry", role: "Beneficiario global de conflictos"},
            {id: "OIL", name: "Sector Petrolero", type: "industry", role: "Control recursos energéticos"},
            {id: "GOLD", name: "Minería Oro", type: "industry", role: "Financiación conflictos África"},
            {id: "PMC", name: "Contratistas Militares", type: "industry", role: "Privatización guerra"},
            
            // Organizaciones
            {id: "UN", name: "ONU", type: "organization", role: "Respuesta humanitaria limitada"},
            {id: "NATO", name: "OTAN", type: "organization", role: "Alianza militar occidental"},
            
            // Grupos Armados
            {id: "ISIS", name: "ISIS", type: "militant", role: "Terrorismo transnacional, surgió de Al-Qaeda Irak"},
            {id: "TAL", name: "Talibanes", type: "militant", role: "Victoria Afganistán, apoyo histórico Pakistán/EEUU"},
            {id: "BH", name: "Boko Haram", type: "militant", role: "Insurgencia Nigeria"},
            {id: "HAMAS", name: "Hamas", type: "militant", role: "Gobierno Gaza, apoyo Irán/Qatar"},
            {id: "HEID", name: "Hezbollah", type: "militant", role: "Partido-milicia Líbano, proxy Irán"},
            {id: "AQ", name: "Al-Qaeda", type: "militant", role: "Red terrorista global, históricamente apoyada"},
            {id: "HOUT", name: "Hutíes", type: "militant", role: "Control norte Yemen, apoyo Irán"}
        ];

        const links = [
            // Conexiones principales beneficiarios directos
            {source: "PI", target: "US", type: "direct", relation: "Apoyo militar y político"},
            {source: "PI", target: "IL", type: "direct", relation: "Ocupante principal"},
            {source: "PI", target: "ARMS", type: "direct", relation: "Consumidor armas"},
            
            {source: "SY", target: "RU", type: "direct", relation: "Intervención militar directa"},
            {source: "SY", target: "IR", type: "direct", relation: "Apoyo régimen Assad"},
            {source: "SY", target: "TR", type: "direct", relation: "Control territorios norte"},
            
            {source: "YE", target: "SA", type: "direct", relation: "Líder coalición militar"},
            {source: "YE", target: "UAE", type: "direct", relation: "Socio coalición"},
            {source: "YE", target: "ARMS", type: "direct", relation: "Comprador masivo armas"},
            
            {source: "AF", target: "TAL", type: "direct", relation: "Victoria final"},
            {source: "AF", target: "PK", type: "direct", relation: "Apoyo talibanes"},
            {source: "AF", target: "CN", type: "direct", relation: "Acceso recursos minerales"},
            
            {source: "IQ", target: "IR", type: "direct", relation: "Influencia post-invasión"},
            {source: "IQ", target: "PMC", type: "direct", relation: "Contratos reconstrucción"},
            {source: "IQ", target: "OIL", type: "direct", relation: "Control recursos petroleros"},
            
            {source: "SD", target: "UAE", type: "direct", relation: "Apoyo RSF, acceso oro"},
            {source: "SD", target: "EG", type: "direct", relation: "Apoyo SAF, estabilidad"},
            {source: "SD", target: "GOLD", type: "direct", relation: "Control minas oro"},
            
            {source: "NG", target: "FR", type: "direct", relation: "Operaciones antiterroristas"},
            {source: "NG", target: "BH", type: "direct", relation: "Insurgencia activa"},
            
            // Conexiones transversales industria armamentística
            {source: "ARMS", target: "US", type: "industry", relation: "Principal exportador global"},
            {source: "ARMS", target: "RU", type: "industry", relation: "Segundo exportador mundial"},
            {source: "ARMS", target: "UK", type: "industry", relation: "Exportador principal Europa"},
            {source: "ARMS", target: "FR", type: "industry", relation: "Cuarto exportador mundial"},
            
            // ISIS en múltiples teatros
            {source: "ISIS", target: "SY", type: "militant", relation: "Territorio histórico"},
            {source: "ISIS", target: "IQ", type: "militant", relation: "Califato declarado"},
            {source: "ISIS", target: "AF", type: "militant", relation: "Franquicia ISIS-K"},
            {source: "ISIS", target: "NG", type: "militant", relation: "Afiliación Boko Haram"},
            
            // CONEXIONES HISTÓRICAS Y ACTUALES GRUPOS ARMADOS CON PAÍSES
            
            // Talibanes - Conexiones históricas EEUU y actuales
            {source: "TAL", target: "US", type: "historical", relation: "Apoyo EEUU vs URSS 1980s, enemigo 2001-2021"},
            {source: "TAL", target: "PK", type: "direct", relation: "Apoyo ISI, refugio histórico"},
            {source: "TAL", target: "QA", type: "direct", relation: "Oficina política Doha, mediación"},
            {source: "TAL", target: "CN", type: "current", relation: "Reconocimiento de facto, inversiones"},
            {source: "TAL", target: "RU", type: "current", relation: "Cooperación contra ISIS-K"},
            {source: "TAL", target: "IR", type: "current", relation: "Relaciones pragmáticas fronterizas"},
            
            // Hamas - Red de apoyo
            {source: "HAMAS", target: "IR", type: "direct", relation: "Financiación, entrenamiento, armas"},
            {source: "HAMAS", target: "QA", type: "direct", relation: "Financiación, refugio liderazgo"},
            {source: "HAMAS", target: "TR", type: "indirect", relation: "Apoyo político, refugio ocasional"},
            {source: "HAMAS", target: "SY_STATE", type: "historical", relation: "Oficinas históricas Damasco"},
            {source: "HAMAS", target: "LB", type: "indirect", relation: "Coordinación con Hezbollah"},
            
            // Hezbollah - Proxy Irán
            {source: "HEID", target: "IR", type: "direct", relation: "Creado y financiado por Irán"},
            {source: "HEID", target: "LB", type: "direct", relation: "Partido político dominante"},
            {source: "HEID", target: "SY_STATE", type: "direct", relation: "Intervención militar apoyando Assad"},
            {source: "HEID", target: "YE", type: "indirect", relation: "Entrenamiento hutíes"},
            
            // Hutíes - Apoyo iraní
            {source: "HOUT", target: "IR", type: "direct", relation: "Armas, entrenamiento, asesoría"},
            {source: "HOUT", target: "HEID", type: "indirect", relation: "Entrenamiento y coordinación"},
            {source: "YE", target: "HOUT", type: "direct", relation: "Control norte Yemen, capital Saná"},
            
            // ISIS - Conexiones complejas origen
            {source: "ISIS", target: "US", type: "historical", relation: "Surgió de vacío post-invasión Irak"},
            {source: "ISIS", target: "AQ", type: "historical", relation: "Escisión Al-Qaeda Irak"},
            {source: "ISIS", target: "SA", type: "indirect", relation: "Financiación privada inicial ciudadanos"},
            {source: "ISIS", target: "TR", type: "historical", relation: "Frontera porosa, petróleo ilegal"},
            
            // Al-Qaeda - Conexiones históricas
            {source: "AQ", target: "US", type: "historical", relation: "Apoyo anti-soviético, enemigo post-11S"},
            {source: "AQ", target: "PK", type: "historical", relation: "Refugio tribal, apoyo ISI"},
            {source: "AQ", target: "SA", type: "historical", relation: "Origen ideológico wahabí"},
            {source: "AQ", target: "YE", target: "HOUT", type: "militant", relation: "AQPA vs Hutíes"},
            
            // Boko Haram - Conexiones regionales
            {source: "BH", target: "TD", type: "indirect", relation: "Operaciones transfronterizas"},
            {source: "BH", target: "ISIS", type: "direct", relation: "Lealtad declarada 2015"},
            {source: "BH", target: "FR", type: "indirect", relation: "Justificación intervención francesa"},
            
            // Conexiones refugiados
            {source: "SY", target: "JO", type: "indirect", relation: "Campo refugiados masivo"},
            {source: "SY", target: "TR", type: "indirect", relation: "3.6M refugiados sirios"},
            {source: "AF", target: "PK", type: "indirect", relation: "Millones refugiados afganos"},
            {source: "SD", target: "TD", type: "indirect", relation: "Flujo masivo refugiados"},
            
            // Superpotencias en múltiples conflictos
            {source: "US", target: "PI", type: "geopolitical", relation: "$3.8B ayuda militar anual"},
            {source: "US", target: "AF", type: "geopolitical", relation: "Guerra más larga 20 años"},
            {source: "US", target: "IQ", type: "geopolitical", relation: "Invasión 2003"},
            {source: "US", target: "YE", type: "geopolitical", relation: "Apoyo coalición saudí"},
            
            {source: "RU", target: "SY", type: "geopolitical", relation: "Cambio curso guerra"},
            {source: "RU", target: "SD", type: "geopolitical", relation: "Grupos Wagner"},
            
            {source: "CN", target: "AF", type: "geopolitical", relation: "Extracción litio post-Taliban"},
            {source: "CN", target: "IQ", type: "geopolitical", relation: "Contratos petróleo post-guerra"},
            {source: "CN", target: "SY", type: "geopolitical", relation: "Reconstrucción Franja y Ruta"},
            
            // Irán eje resistencia
            {source: "IR", target: "SY", type: "proxy", relation: "Apoyo Assad, Hezbollah"},
            {source: "IR", target: "YE", type: "proxy", relation: "Apoyo hutíes"},
            {source: "IR", target: "PI", type: "proxy", relation: "Apoyo Hamas, Hezbollah"}
        ];

        // Colores por tipo
        const colors = {
            conflict: "#ff6b6b",
            superpower: "#0984e3", 
            regional: "#74b9ff",
            secondary: "#00b894",
            industry: "#fdcb6e",
            organization: "#a29bfe",
            militant: "#636e72"
        };

        // Colores de enlaces por tipo
        const linkColors = {
            direct: "#e94560",
            indirect: "#f39c12",
            industry: "#9b59b6",
            geopolitical: "#3498db",
            proxy: "#e74c3c",
            militant: "#95a5a6",
            historical: "#8e44ad",
            current: "#27ae60"
        };

        // Configuración de la simulación
        const simulation = d3.forceSimulation(nodes)
            .force("link", d3.forceLink(links).id(d => d.id).distance(100).strength(0.3))
            .force("charge", d3.forceManyBody().strength(-800))
            .force("center", d3.forceCenter(width / 2, height / 2))
            .force("collision", d3.forceCollide().radius(25));

        // Crear enlaces
        const link = g.append("g")
            .selectAll("line")
            .data(links)
            .enter().append("line")
            .attr("stroke", d => linkColors[d.type] || "#999")
            .attr("stroke-opacity", 0.6)
            .attr("stroke-width", d => d.type === 'direct' ? 3 : 1.5);

        // Crear nodos
        const node = g.append("g")
            .selectAll("circle")
            .data(nodes)
            .enter().append("circle")
            .attr("r", d => {
                if (d.type === "conflict") return 20;
                if (d.type === "superpower") return 18;
                if (d.type === "regional") return 15;
                return 12;
            })
            .attr("fill", d => colors[d.type])
            .attr("stroke", "#fff")
            .attr("stroke-width", 2)
            .call(d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended))
            .on("mouseover", showTooltip)
            .on("mouseout", hideTooltip);

        // Etiquetas de nodos
        const labels = g.append("g")
            .selectAll("text")
            .data(nodes)
            .enter().append("text")
            .attr("class", "node-label")
            .text(d => d.name.length > 12 ? d.name.substring(0, 12) + "..." : d.name)
            .attr("dy", 35);

        // Actualizar posiciones en cada tick
        simulation.on("tick", () => {
            link
                .attr("x1", d => d.source.x)
                .attr("y1", d => d.source.y)
                .attr("x2", d => d.target.x)
                .attr("y2", d => d.target.y);

            node
                .attr("cx", d => d.x)
                .attr("cy", d => d.y);

            labels
                .attr("x", d => d.x)
                .attr("y", d => d.y);
        });

        // Funciones de drag
        function dragstarted(event, d) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y;
        }

        function dragged(event, d) {
            d.fx = event.x;
            d.fy = event.y;
        }

        function dragended(event, d) {
            if (!event.active) simulation.alphaTarget(0);
            d.fx = null;
            d.fy = null;
        }

        // Funciones de tooltip
        function showTooltip(event, d) {
            tooltip.transition().duration(200).style("opacity", 1);
            let content = `<strong>${d.name}</strong><br/>`;
            if (d.casualties) content += `Víctimas: ${d.casualties}<br/>`;
            if (d.role) content += `Rol: ${d.role}<br/>`;
            if (d.description) content += `${d.description}`;
            
            tooltip.html(content)
                .style("left", (event.pageX + 10) + "px")
                .style("top", (event.pageY - 10) + "px");
        }

        function hideTooltip() {
            tooltip.transition().duration(200).style("opacity", 0);
        }

        // Funciones de control
        function resetZoom() {
            svg.transition().duration(750).call(
                zoom.transform,
                d3.zoomIdentity
            );
        }

        let simulationRunning = true;
        function pauseSimulation() {
            if (simulationRunning) {
                simulation.stop();
                simulationRunning = false;
            } else {
                simulation.restart();
                simulationRunning = true;
            }
        }

        // Responsivo
        window.addEventListener('resize', () => {
            const newWidth = window.innerWidth - 40;
            svg.attr("width", newWidth);
            simulation.force("center", d3.forceCenter(newWidth / 2, height / 2));
            simulation.alpha(0.3).restart();
        });
    </script>
</body>
</html>