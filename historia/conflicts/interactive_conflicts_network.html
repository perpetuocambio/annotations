<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red Interactiva de Conflictos Globales</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #1a1a2e;
            color: white;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #e94560;
            margin-bottom: 20px;
        }
        
        .methodology {
            background: #16213e;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #e94560;
        }
        
        .controls {
            text-align: center;
            margin-bottom: 20px;
            background: #16213e;
            padding: 15px;
            border-radius: 8px;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            border: 2px solid #fff;
        }
        
        #network {
            border: 2px solid #0f4c75;
            border-radius: 8px;
            background: #0f1419;
            display: block;
            margin: 0 auto;
        }
        
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 15px;
            border-radius: 8px;
            font-size: 12px;
            max-width: 300px;
            pointer-events: none;
            border: 1px solid #e94560;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            z-index: 1000;
            opacity: 0;
        }
        
        .confidence-indicator {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 10px;
            font-weight: bold;
            margin-left: 5px;
        }
        
        .confidence-high { background: #27ae60; color: white; }
        .confidence-medium { background: #f39c12; color: white; }
        .confidence-low { background: #e74c3c; color: white; }
        
        button {
            background: #e94560;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 5px;
            font-size: 12px;
        }
        
        button:hover {
            background: #c73650;
        }
        
        button.active {
            background: #74b9ff;
        }
        
        .filters {
            margin: 10px 0;
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .temporal-selector {
            margin: 15px 0;
        }
        
        .temporal-selector input[type="range"] {
            width: 300px;
            margin: 0 10px;
        }
        
        #yearDisplay {
            font-weight: bold;
            color: #e94560;
            font-size: 18px;
        }

        .node-label {
            font-size: 10px;
            fill: white;
            text-anchor: middle;
            pointer-events: none;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }

        .link {
            stroke-opacity: 0.6;
        }

        .node {
            stroke: #fff;
            stroke-width: 2px;
            cursor: pointer;
        }

        .node:hover {
            stroke-width: 3px;
        }

        /* Estilos para sección explicaciones */
        .explanations-section {
            margin-top: 40px;
            padding: 20px;
            background: #16213e;
            border-radius: 12px;
        }
        
        .explanations-section h2 {
            color: #e94560;
            text-align: center;
            margin-bottom: 30px;
            font-size: 28px;
        }
        
        .category-section {
            margin-bottom: 40px;
        }
        
        .category-section h3 {
            color: #74b9ff;
            margin-bottom: 20px;
            font-size: 22px;
            border-bottom: 2px solid #74b9ff;
            padding-bottom: 8px;
        }
        
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .connection-card {
            background: #0f1419;
            border-radius: 8px;
            padding: 20px;
            border: 2px solid;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        .connection-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(233, 69, 96, 0.3);
        }
        
        .connection-card.historical {
            border-color: #8e44ad;
        }
        
        .connection-card.proxy {
            border-color: #e74c3c;
        }
        
        .connection-card.industry {
            border-color: #fdcb6e;
        }
        
        .connection-card.indirect {
            border-color: #f39c12;
        }
        
        .connection-card h4 {
            color: #e94560;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .connection-card h5 {
            color: #74b9ff;
            margin: 10px 0 5px 0;
            font-size: 16px;
        }
        
        .timeline {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
        }
        
        .timeline-item {
            display: flex;
            margin-bottom: 10px;
            align-items: flex-start;
        }
        
        .timeline-item .year {
            background: #e94560;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            min-width: 80px;
            text-align: center;
            margin-right: 10px;
        }
        
        .timeline-item .desc {
            flex: 1;
            font-size: 14px;
        }
        
        .double-game {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 15px 0;
        }
        
        .side {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
        }
        
        .qatar-roles .role {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 10px;
        }
        
        .iran-proxies {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .proxy-group {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #e74c3c;
        }
        
        .arms-trade {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .exporter {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #fdcb6e;
        }
        
        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .resource {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #00b894;
        }
        
        .refugee-flows .flow {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 10px;
            border-left: 4px solid #f39c12;
        }
        
        .humanitarian-politics {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
        }
        
        .connection-card ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .connection-card li {
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .connection-card p {
            margin: 10px 0;
            line-height: 1.5;
            font-size: 14px;
        }
        
        .funding-sources {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin: 15px 0;
        }
        
        .source {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #74b9ff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Red Global de Conflictos Armados - Todas las Conexiones</h1>
        
        <div class="methodology">
            <h3>Metodología y Fuentes</h3>
            <p>Esta visualización muestra TODAS las conexiones documentadas sin filtros temporales restrictivos. 
            Incluye relaciones históricas, actuales, directas e indirectas basadas en evidencia verificable.</p>
        </div>
        
        <div class="controls">
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: #ff6b6b;"></div>
                    <span>Conflictos</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #0984e3;"></div>
                    <span>Superpotencias</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #74b9ff;"></div>
                    <span>Potencias Regionales</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #00b894;"></div>
                    <span>Países Secundarios</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #fdcb6e;"></div>
                    <span>Industrias</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #a29bfe;"></div>
                    <span>Organizaciones</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #636e72;"></div>
                    <span>Grupos Armados</span>
                </div>
            </div>
            
            <div class="filters">
                <button id="filterAll" class="active">Todas las Conexiones</button>
                <button id="filterHigh">Solo Alta Confianza</button>
                <button id="filterHistorical">Solo Históricas</button>
                <button id="filterCurrent">Solo Actuales</button>
                <button id="resetZoom">Reiniciar Vista</button>
            </div>
        </div>
        
        <svg id="network" width="1200" height="800"></svg>
        
        <!-- Sección de Cards Explicativas -->
        <div class="explanations-section">
            <h2>Análisis Detallado de Conexiones</h2>
            
            <!-- Cards por categorías -->
            <div class="category-section">
                <h3>🔴 Conexiones Paradójicas: De Aliados a Enemigos</h3>
                <div class="cards-grid">
                    <div class="connection-card historical">
                        <h4>EEUU ↔ Talibanes</h4>
                        <div class="timeline">
                            <div class="timeline-item">
                                <span class="year">1980s</span>
                                <span class="desc">EEUU financia y entrena muyahidines (incluidos futuros talibanes) contra URSS vía Pakistán. Operación Ciclón: $3 mil millones.</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">1996-2001</span>
                                <span class="desc">Talibanes toman poder. EEUU mantiene relaciones pragmáticas por oleoductos.</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">2001-2021</span>
                                <span class="desc">Guerra total. EEUU invade tras 11-S. $2.3 billones gastados, 170,000+ muertes.</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">2018-2021</span>
                                <span class="desc">Negociaciones directas Doha. EEUU reconoce talibanes como interlocutor legítimo.</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">2021-presente</span>
                                <span class="desc">Victoria Taliban. EEUU mantiene contactos por terrorismo y ayuda humanitaria.</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="connection-card historical">
                        <h4>EEUU → ISIS (Consecuencia No Intencionada)</h4>
                        <p><strong>Cadena causal:</strong></p>
                        <ul>
                            <li><strong>2003:</strong> Invasión Irak destruye Estado iraquí</li>
                            <li><strong>2003-2006:</strong> Desmantelamiento ejército iraquí crea insurgencia</li>
                            <li><strong>2004:</strong> Surge "Al-Qaeda en Irak" liderado por Al-Zarqawi</li>
                            <li><strong>2006-2013:</strong> Evoluciona a "Estado Islámico de Irak"</li>
                            <li><strong>2013:</strong> Se expande a Siria = ISIS</li>
                            <li><strong>2014:</strong> Declara "Califato" en territorio iraquí-sirio</li>
                        </ul>
                        <p><strong>Ironía:</strong> EEUU crea la coalición anti-ISIS para combatir lo que indirectamente ayudó a crear.</p>
                    </div>
                    
                    <div class="connection-card historical">
                        <h4>🇮🇱 Israel → Hamas: Creación y Financiación Documentada</h4>
                        <h5>📋 Evidencias Principales - Fuentes Verificadas de Alto Nivel</h5>
                        <div class="timeline">
                            <div class="timeline-item">
                                <span class="year">1984</span>
                                <span class="desc"><strong>Licencia oficial:</strong> Gobernador Militar israelí otorga licencia a Sheikh Ahmed Yassin para crear "Mujama al-Islamiya" (precursor Hamas)</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">1980s</span>
                                <span class="desc"><strong>Testimonio oficial:</strong> Avner Cohen (ex funcionario israelí): "Hamas, para mi gran pesar, es creación de Israel"</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">1988</span>
                                <span class="desc"><strong>Cable WikiLeaks 88JERUSALEM3168:</strong> "Muchos en Cisjordania creen que Israel apoya activamente a Hamas para dividir a los palestinos"</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">2012-2021</span>
                                <span class="desc"><strong>Transferencias Qatar:</strong> $1.8 mil millones transferidos a Gaza vía Israel con aprobación israelí</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">2018-2021</span>
                                <span class="desc"><strong>Maletas documentadas:</strong> $15 millones mensuales de Qatar a Gaza vía territorio israelí</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">2019</span>
                                <span class="desc"><strong>Netanyahu (Knesset):</strong> "Dinero a Hamas es parte de la estrategia para mantener divididos a los palestinos"</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">2023</span>
                                <span class="desc"><strong>Shin Bet:</strong> Netanyahu advertido dos veces sobre fondos qataríes al ala militar de Hamas</span>
                            </div>
                            <div class="timeline-item">
                                <span class="year">2025</span>
                                <span class="desc"><strong>Documentos capturados:</strong> Papeles Hamas muestran fondos qataríes eran "arteria principal" financiera</span>
                            </div>
                        </div>
                        <p><strong>Patrón estratégico:</strong> Israel facilita financiación Hamas para debilitar Autoridad Palestina secular, manteniendo palestinos divididos.</p>
                    </div>
                </div>
            </div>
            
            <div class="category-section">
                <h3>El Juego Doble: Aliados que Apoyan Enemigos</h3>
                <div class="cards-grid">
                    <div class="connection-card proxy">
                        <h4>Pakistán: Aliado EEUU que Apoya Talibanes</h4>
                        <div class="double-game">
                            <div class="side">
                                <h5>Como Aliado EEUU:</h5>
                                <ul>
                                    <li>$33 mil millones ayuda militar 2002-2017</li>
                                    <li>Operaciones antiterroristas conjuntas</li>
                                    <li>Bases para drones estadounidenses</li>
                                    <li>Captura líderes Al-Qaeda (incluido KSM)</li>
                                </ul>
                            </div>
                            <div class="side">
                                <h5>Como Apoyo Taliban:</h5>
                                <ul>
                                    <li>ISI entrena y financia talibanes</li>
                                    <li>Refugio seguro en áreas tribales</li>
                                    <li>Hospitales para heridos taliban</li>
                                    <li>"Profundidad estratégica" vs India</li>
                                </ul>
                            </div>
                        </div>
                        <p><strong>Resultado:</strong> Pakistán cobra por ayudar a EEUU mientras asegura que EEUU no pueda ganar.</p>
                    </div>
                    
                    <div class="connection-card proxy">
                        <h4>Qatar: El Mediador Financiador</h4>
                        <div class="qatar-roles">
                            <div class="role">
                                <h5>Financia Hamas:</h5>
                                <p>$1.1 mil millones transferidos a Gaza 2012-2021. Salarios funcionarios, combustible, proyectos infraestructura.</p>
                            </div>
                            <div class="role">
                                <h5>Hospeda Oficina Taliban:</h5>
                                <p>Oficina política Taliban en Doha desde 2013. Negociaciones directas EEUU-Taliban.</p>
                            </div>
                            <div class="role">
                                <h5>Base Militar EEUU:</h5>
                                <p>Base Aérea Al Udeid: 11,000 soldados estadounidenses. Centro operaciones regionales.</p>
                            </div>
                        </div>
                        <p><strong>Paradoja:</strong> Qatar financia enemigos de Israel mientras aloja bases que protegen Israel.</p>
                    </div>
                    
                    <div class="connection-card proxy">
                        <h4>🏦 Red Financiera Hamas: Múltiples Fuentes Documentadas</h4>
                        <div class="funding-sources">
                            <div class="source">
                                <h5>🇶🇦 Qatar (Financiador Principal):</h5>
                                <ul>
                                    <li><strong>2012-2021:</strong> $1.8 mil millones transferidos oficialmente</li>
                                    <li><strong>Método:</strong> Maletas con $15M mensuales vía Israel</li>
                                    <li><strong>Cobertura:</strong> Salarios funcionarios, combustible, proyectos</li>
                                    <li><strong>2025:</strong> Documentos capturados confirman "arteria principal"</li>
                                </ul>
                            </div>
                            <div class="source">
                                <h5>🇮🇷 Irán (Apoyo Militar-Financiero):</h5>
                                <ul>
                                    <li><strong>Monto:</strong> $100M+ anuales estimados</li>
                                    <li><strong>Enfoque:</strong> Brigadas Qassam (ala militar)</li>
                                    <li><strong>Transferencia:</strong> Túneles, contrabando, criptomonedas</li>
                                    <li><strong>Entrenamiento:</strong> Comandos Hamas en Irán</li>
                                </ul>
                            </div>
                            <div class="source">
                                <h5>💼 Fuentes Privadas:</h5>
                                <ul>
                                    <li><strong>Caridades Islámicas:</strong> Red global donaciones</li>
                                    <li><strong>Criptomonedas:</strong> Bitcoin, Ethereum para evitar sanciones</li>
                                    <li><strong>Negocios Gaza:</strong> Impuestos, tasas, monopolios</li>
                                    <li><strong>Diáspora:</strong> Contribuciones palestinos globales</li>
                                </ul>
                            </div>
                        </div>
                        <p><strong>Paradoja Estratégica:</strong> Israel facilita financiación Qatar-Hamas para mantener palestinos divididos, mientras combate financiación iraní-Hamas.</p>
                    </div>
                </div>
            </div>
            
            <div class="category-section">
                <h3>El Eje de Resistencia Iraní</h3>
                <div class="cards-grid">
                    <div class="connection-card proxy">
                        <h4>Irán: Arquitecto de Red Proxy</h4>
                        <div class="iran-proxies">
                            <div class="proxy-group">
                                <h5>Hezbollah (Líbano)</h5>
                                <ul>
                                    <li><strong>Presupuesto:</strong> $700M anuales</li>
                                    <li><strong>Arsenal:</strong> 130,000+ cohetes/misiles</li>
                                    <li><strong>Combatientes:</strong> 20,000+ activos</li>
                                    <li><strong>Rol:</strong> Partido dominante + milicia</li>
                                </ul>
                            </div>
                            <div class="proxy-group">
                                <h5>Hamas (Gaza)</h5>
                                <ul>
                                    <li><strong>Apoyo:</strong> $100M+ anuales</li>
                                    <li><strong>Entrenamiento:</strong> Comandos en Irán</li>
                                    <li><strong>Armas:</strong> Transferencia vía túneles</li>
                                    <li><strong>Coordinación:</strong> Ataques sincronizados</li>
                                </ul>
                            </div>
                            <div class="proxy-group">
                                <h5>Hutíes (Yemen)</h5>
                                <ul>
                                    <li><strong>Armas:</strong> Misiles balísticos avanzados</li>
                                    <li><strong>Asesores:</strong> IRGC y Hezbollah</li>
                                    <li><strong>Objetivo:</strong> Presión sobre Arabia Saudí</li>
                                    <li><strong>Bloqueo:</strong> Estrecho Bab el-Mandab</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="category-section">
                <h3>Complejo Militar-Industrial Global</h3>
                <div class="cards-grid">
                    <div class="connection-card industry">
                        <h4>Industria Armamentística: Los Verdaderos Ganadores</h4>
                        <div class="arms-trade">
                            <div class="exporter">
                                <h5>Estados Unidos (39% global)</h5>
                                <ul>
                                    <li>Lockheed Martin, Boeing, Raytheon</li>
                                    <li>Principales clientes: Arabia Saudí, Israel</li>
                                    <li>Yemen: $54.6B armas a coalición saudí</li>
                                </ul>
                            </div>
                            <div class="exporter">
                                <h5>Rusia (20% global)</h5>
                                <ul>
                                    <li>Rosoboronexport, Kalashnikov</li>
                                    <li>Principales clientes: India, China, Siria</li>
                                    <li>Siria: Sistemas S-400, jets Su-30</li>
                                </ul>
                            </div>
                            <div class="exporter">
                                <h5>Francia (8% global)</h5>
                                <ul>
                                    <li>Dassault, Thales, Naval Group</li>
                                    <li>Yemen: Jets Mirage a EAU</li>
                                    <li>África: Justifica intervención = ventas</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="connection-card industry">
                        <h4>Recursos Naturales como Motor de Conflicto</h4>
                        <div class="resources-grid">
                            <div class="resource">
                                <h5>Petróleo - Irak/Siria</h5>
                                <p>China obtiene contratos petroleros post-guerra. ISIS vendió petróleo $500M vía Turquía.</p>
                            </div>
                            <div class="resource">
                                <h5>Oro - Sudán</h5>
                                <p>EAU apoya RSF para acceder minas oro. 90+ toneladas exportadas ilegalmente.</p>
                            </div>
                            <div class="resource">
                                <h5>Litio - Afganistán</h5>
                                <p>China negocia con Taliban acceso $1 billón reservas minerales.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="category-section">
                <h3>Crisis Humanitarias como Herramientas Geopolíticas</h3>
                <div class="cards-grid">
                    <div class="connection-card indirect">
                        <h4>Refugiados como Arma Diplomática</h4>
                        <div class="refugee-flows">
                            <div class="flow">
                                <h5>Siria → Turquía</h5>
                                <p><strong>3.6M refugiados sirios.</strong> Turquía usa como palanca sobre UE: "€6 mil millones o abro fronteras"</p>
                            </div>
                            <div class="flow">
                                <h5>Sudán → Chad</h5>
                                <p><strong>1.2M refugiados.</strong> Chad recibe fondos internacionales, Francia mantiene influencia regional.</p>
                            </div>
                            <div class="flow">
                                <h5>Afganistán → Pakistán</h5>
                                <p><strong>3M+ refugiados históricos.</strong> Pakistán recibe ayuda internacional, justifica políticas pro-Taliban.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="connection-card indirect">
                        <h4>Ayuda Humanitaria = Influencia Política</h4>
                        <div class="humanitarian-politics">
                            <p><strong>Patrón global:</strong> Países crean crisis → ofrecen ayuda humanitaria → ganan influencia</p>
                            <ul>
                                <li><strong>Arabia Saudí:</strong> Destruye Yemen, dona $500M ayuda humanitaria</li>
                                <li><strong>Turquía:</strong> Interviene Siria, aloja refugiados, gana € de UE</li>
                                <li><strong>Francia:</strong> Interviene Sahel, "protege" civiles, mantiene influencia</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        console.log("Iniciando script completo...");
        
        const svg = d3.select("#network");
        const width = 1200;
        const height = 800;
        
        const g = svg.append("g");
        
        const zoom = d3.zoom()
            .scaleExtent([0.3, 3])
            .on("zoom", function(event) {
                g.attr("transform", event.transform);
            });
            
        svg.call(zoom);

        const tooltip = d3.select("body").append("div")
            .attr("class", "tooltip");

        // DATOS COMPLETOS - Todos los nodos sin filtrar
        const nodes = [
            // Conflictos
            { id: "Palestine", name: "Palestina", type: "conflict", size: 25, casualties: "150,000+" },
            { id: "Afghanistan", name: "Afganistán", type: "conflict", size: 25, casualties: "212,191" },
            { id: "Syria", name: "Siria", type: "conflict", size: 25, casualties: "656,493" },
            { id: "Iraq", name: "Irak", type: "conflict", size: 25, casualties: "300,000-500,000" },
            { id: "Yemen", name: "Yemen", type: "conflict", size: 25, casualties: "400,000+" },
            { id: "Sudan", name: "Sudán", type: "conflict", size: 25, casualties: "150,000" },
            { id: "Libya", name: "Libia", type: "conflict", size: 20, casualties: "25,000+" },
            { id: "Mali", name: "Mali", type: "conflict", size: 20, casualties: "15,000+" },
            { id: "Somalia", name: "Somalia", type: "conflict", size: 20, casualties: "500,000+" },
            { id: "Myanmar", name: "Myanmar", type: "conflict", size: 20, casualties: "50,000+" },
            
            // Estados - Superpotencias
            { id: "USA", name: "EEUU", type: "superpower", size: 35 },
            { id: "Russia", name: "Rusia", type: "superpower", size: 35 },
            { id: "China", name: "China", type: "superpower", size: 35 },
            
            // Estados - Potencias Regionales
            { id: "Israel", name: "Israel", type: "regional", size: 25 },
            { id: "Iran", name: "Irán", type: "regional", size: 25 },
            { id: "Saudi", name: "Arabia Saudí", type: "regional", size: 25 },
            { id: "Turkey", name: "Turquía", type: "regional", size: 25 },
            { id: "UAE", name: "Emiratos", type: "regional", size: 25 },
            { id: "Egypt", name: "Egipto", type: "regional", size: 25 },
            { id: "Pakistan", name: "Pakistán", type: "regional", size: 25 },
            
            // Estados - Países Secundarios
            { id: "Qatar", name: "Qatar", type: "secondary", size: 20 },
            { id: "Jordan", name: "Jordania", type: "secondary", size: 20 },
            { id: "Lebanon", name: "Líbano", type: "secondary", size: 20 },
            { id: "France", name: "Francia", type: "secondary", size: 20 },
            { id: "UK", name: "Reino Unido", type: "secondary", size: 20 },
            { id: "Germany", name: "Alemania", type: "secondary", size: 20 },
            { id: "Chad", name: "Chad", type: "secondary", size: 15 },
            { id: "Niger", name: "Níger", type: "secondary", size: 15 },
            { id: "Ethiopia", name: "Etiopía", type: "secondary", size: 20 },
            { id: "Kenya", name: "Kenia", type: "secondary", size: 15 },
            { id: "Bangladesh", name: "Bangladesh", type: "secondary", size: 15 },
            
            // Industrias
            { id: "Arms", name: "Industria Armamentística", type: "industry", size: 25 },
            { id: "Oil", name: "Sector Petrolero", type: "industry", size: 25 },
            { id: "Mining", name: "Minería", type: "industry", size: 20 },
            { id: "PMC", name: "Contratistas Militares", type: "industry", size: 20 },
            
            // Organizaciones
            { id: "UN", name: "ONU", type: "organization", size: 20 },
            { id: "NATO", name: "OTAN", type: "organization", size: 20 },
            { id: "EU", name: "Unión Europea", type: "organization", size: 20 },
            { id: "AU", name: "Unión Africana", type: "organization", size: 15 },
            
            // Grupos Militantes
            { id: "Hamas", name: "Hamas", type: "militant", size: 22 },
            { id: "Taliban", name: "Taliban", type: "militant", size: 22 },
            { id: "ISIS", name: "ISIS", type: "militant", size: 22 },
            { id: "Hezbollah", name: "Hezbollah", type: "militant", size: 22 },
            { id: "AlQaeda", name: "Al-Qaeda", type: "militant", size: 20 },
            { id: "Houthis", name: "Hutíes", type: "militant", size: 20 },
            { id: "BokoHaram", name: "Boko Haram", type: "militant", size: 18 },
            { id: "AlShabaab", name: "Al-Shabaab", type: "militant", size: 18 },
            { id: "PKK", name: "PKK", type: "militant", size: 18 },
            { id: "Wagner", name: "Grupo Wagner", type: "militant", size: 20 },
            { id: "RSF", name: "RSF Sudán", type: "militant", size: 18 }
        ];

        // ENLACES COMPLETOS - Todas las conexiones documentadas
        const links = [
            // Conexiones históricas paradójicas EEUU
            { source: "USA", target: "Taliban", confidence: "high", type: "historical", description: "Apoyo anti-soviético 1980s → Guerra 2001-2021 → Negociaciones directas 2018-2021" },
            { source: "USA", target: "AlQaeda", confidence: "high", type: "historical", description: "Financiación muyahidines 1980s → Enemigo post-11S" },
            { source: "USA", target: "ISIS", confidence: "medium", type: "indirect", description: "Invasión Irak 2003 creó vacío de poder → Surgimiento ISIS" },
            { source: "USA", target: "Pakistan", confidence: "high", type: "alliance", description: "$33 mil millones ayuda militar mientras Pakistán apoya Taliban" },
            
            // Red proxy iraní - Eje de resistencia
            { source: "Iran", target: "Hezbollah", confidence: "high", type: "creation", description: "Creado 1982, $700M anuales, 130,000 cohetes" },
            { source: "Iran", target: "Hamas", confidence: "high", type: "support", description: "$100M+ anuales, entrenamiento, transferencia armas" },
            { source: "Iran", target: "Houthis", confidence: "high", type: "support", description: "Misiles balísticos, asesores IRGC, bloqueo Mar Rojo" },
            { source: "Iran", target: "Syria", confidence: "high", type: "alliance", description: "Apoyo militar Assad, corredor terrestre Líbano" },
            
            // Qatar: Mediador-financiador paradójico
            { source: "Qatar", target: "Hamas", confidence: "high", type: "financial", description: "$1.1 mil millones Gaza 2012-2021" },
            { source: "Qatar", target: "Taliban", confidence: "high", type: "diplomatic", description: "Oficina política Doha, mediación EEUU-Taliban" },
            { source: "USA", target: "Qatar", confidence: "high", type: "alliance", description: "Base Al Udeid: 11,000 soldados EEUU" },
            
            // Pakistán: Doble juego documentado
            { source: "Pakistan", target: "Taliban", confidence: "high", type: "support", description: "ISI entrena/financia, refugio seguro áreas tribales" },
            { source: "Pakistan", target: "AlQaeda", confidence: "medium", type: "historical", description: "Refugio tribal, captura líderes para EEUU" },
            
            // Arabia Saudí: Intervención Yemen
            { source: "Saudi", target: "Yemen", confidence: "high", type: "intervention", description: "Coalición militar 2015-presente, $54.6B armas EEUU" },
            { source: "USA", target: "Saudi", confidence: "high", type: "alliance", description: "Principal comprador armas, $100B+ contratos" },
            
            // Rusia: Intervenciones múltiples
            { source: "Russia", target: "Syria", confidence: "high", type: "intervention", description: "Intervención 2015 cambió curso guerra" },
            { source: "Russia", target: "Wagner", confidence: "high", type: "proxy", description: "Operaciones mercenarias negables Siria/África" },
            { source: "Wagner", target: "Sudan", confidence: "high", type: "support", description: "Apoyo RSF, acceso minas oro" },
            { source: "Wagner", target: "Mali", confidence: "high", type: "support", description: "Contrato gobierno malí post-salida Francia" },
            
            // Conexiones conflictos activos
            { source: "Israel", target: "Palestine", confidence: "high", type: "conflict", description: "Ocupación 1967, bloqueo Gaza, asentamientos Cisjordania" },
            { source: "Israel", target: "Hamas", confidence: "high", type: "historical", description: "Apoyo inicial 1987-1990 contra OLP" },
            { source: "Israel", target: "Hezbollah", confidence: "high", type: "conflict", description: "Guerra 2006, enfrentamientos Siria" },
            
            // Turquía: Intervenciones regionales
            { source: "Turkey", target: "Syria", confidence: "high", type: "intervention", description: "Control norte Siria, Escudo Éufrates" },
            { source: "Turkey", target: "Libya", confidence: "high", type: "intervention", description: "Apoyo GNA, drones TB2" },
            { source: "Turkey", target: "PKK", confidence: "high", type: "conflict", description: "Guerra 40 años, operaciones Irak/Siria" },
            
            // China: Beneficiario post-conflicto
            { source: "China", target: "Afghanistan", confidence: "medium", type: "economic", description: "Negociaciones Taliban extracción litio/cobre" },
            { source: "China", target: "Iraq", confidence: "high", type: "economic", description: "Contratos petroleros post-invasión EEUU" },
            
            // Industria armamentística global
            { source: "Arms", target: "USA", confidence: "high", type: "industry", description: "39% exportaciones globales: Lockheed, Boeing, Raytheon" },
            { source: "Arms", target: "Russia", confidence: "high", type: "industry", description: "20% exportaciones: Kalashnikov, Rosoboronexport" },
            { source: "Arms", target: "France", confidence: "high", type: "industry", description: "8% exportaciones: Dassault, Thales" },
            { source: "Arms", target: "Yemen", confidence: "high", type: "supply", description: "Ambos bandos reciben armas masivamente" },
            { source: "Arms", target: "Syria", confidence: "high", type: "supply", description: "Armas rusas/iraníes vs occidentales rebeldes" },
            
            // EAU: Potencia interventora emergente
            { source: "UAE", target: "Yemen", confidence: "high", type: "intervention", description: "Socio Arabia Saudí, control puertos sur" },
            { source: "UAE", target: "Sudan", confidence: "high", type: "support", description: "Apoyo RSF, exportación oro ilegal" },
            { source: "UAE", target: "Libya", confidence: "high", type: "support", description: "Apoyo Haftar, drones chinos" },
            
            // Francia: Intervenciones África
            { source: "France", target: "Mali", confidence: "high", type: "intervention", description: "Operación Serval 2013, Barkhane hasta 2022" },
            { source: "France", target: "Libya", confidence: "medium", type: "intervention", description: "Apoyo Haftar, competencia con Turquía" },
            
            // África Oriental: Al-Shabaab
            { source: "AlShabaab", target: "Somalia", confidence: "high", type: "insurgency", description: "Control rural, ataques Kenia/Etiopía" },
            { source: "USA", target: "Somalia", confidence: "high", type: "intervention", description: "Drones, AFRICOM, apoyo gobierno" },
            { source: "Kenya", target: "Somalia", confidence: "medium", type: "intervention", description: "AMISOM, operaciones antiterroristas" },
            { source: "Ethiopia", target: "Somalia", confidence: "medium", type: "intervention", description: "Intervención histórica, AMISOM" },
            
            // Boko Haram red regional
            { source: "BokoHaram", target: "ISIS", confidence: "medium", type: "affiliation", description: "Lealtad declarada 2015, ISWAP" },
            { source: "BokoHaram", target: "Niger", confidence: "medium", type: "crossborder", description: "Operaciones transfronterizas" },
            { source: "BokoHaram", target: "Chad", confidence: "medium", type: "crossborder", description: "Ataques, respuesta militar" },
            
            // ISIS multi-teatro
            { source: "ISIS", target: "Syria", confidence: "high", type: "territory", description: "Califato Raqqa 2014-2017" },
            { source: "ISIS", target: "Iraq", confidence: "high", type: "territory", description: "Califato Mosul 2014-2017" },
            { source: "ISIS", target: "Libya", confidence: "medium", type: "affiliate", description: "Control Sirte 2014-2016" },
            { source: "ISIS", target: "Afghanistan", confidence: "medium", type: "affiliate", description: "ISIS-K vs Taliban" },
            
            // Refugiados como arma geopolítica
            { source: "Syria", target: "Turkey", confidence: "high", type: "refugees", description: "3.6M refugiados, chantaje UE" },
            { source: "Syria", target: "Jordan", confidence: "high", type: "refugees", description: "1.3M refugiados, campos masivos" },
            { source: "Afghanistan", target: "Pakistan", confidence: "high", type: "refugees", description: "3M+ refugiados históricos" },
            { source: "Sudan", target: "Chad", confidence: "high", type: "refugees", description: "1.2M refugiados crisis actual" },
            { source: "Myanmar", target: "Bangladesh", confidence: "high", type: "refugees", description: "1M+ rohingyas campos Cox's Bazar" },
            
            // Recursos naturales
            { source: "Oil", target: "Syria", confidence: "high", type: "resource", description: "ISIS vendió $500M petróleo vía Turquía" },
            { source: "Oil", target: "Iraq", confidence: "high", type: "resource", description: "Contratos post-invasión China/Occidente" },
            { source: "Mining", target: "Sudan", confidence: "high", type: "resource", description: "90+ toneladas oro exportadas ilegalmente" },
            { source: "Mining", target: "Afghanistan", confidence: "high", type: "resource", description: "$1 billón reservas minerales" },
            
            // Organizaciones internacionales
            { source: "UN", target: "Yemen", confidence: "medium", type: "humanitarian", description: "Mayor crisis humanitaria mundial" },
            { source: "UN", target: "Syria", confidence: "low", type: "diplomatic", description: "Paralizada por vetos Rusia/China" },
            { source: "NATO", target: "Afghanistan", confidence: "high", type: "intervention", description: "Misión 20 años, retirada 2021" },
            { source: "EU", target: "Turkey", confidence: "medium", type: "diplomatic", description: "€6 mil millones acuerdo refugiados" },
            
            // Conexiones Hezbollah multi-teatro
            { source: "Hezbollah", target: "Syria", confidence: "high", type: "intervention", description: "Combate junto Assad desde 2013" },
            { source: "Hezbollah", target: "Yemen", confidence: "medium", type: "training", description: "Entrenamiento hutíes técnicas guerrilla" },
            { source: "Lebanon", target: "Hezbollah", confidence: "high", type: "political", description: "Partido político dominante, Estado paralelo" },
            
            // Red Al-Qaeda global
            { source: "AlQaeda", target: "Mali", confidence: "medium", type: "affiliate", description: "AQIM, control norte pre-2013" },
            { source: "AlQaeda", target: "Somalia", confidence: "medium", type: "support", description: "Apoyo histórico Al-Shabaab" },
            { source: "AlQaeda", target: "Yemen", confidence: "high", type: "affiliate", description: "AQPA, territorio sur Yemen" }
        ];

        // Colores por tipo
        const nodeColors = {
            conflict: "#ff6b6b",
            superpower: "#0984e3", 
            regional: "#74b9ff",
            secondary: "#00b894",
            industry: "#fdcb6e",
            organization: "#a29bfe",
            militant: "#636e72"
        };

        const linkColors = {
            historical: "#a29bfe",
            diplomatic: "#00b894", 
            support: "#ff7675",
            alliance: "#74b9ff",
            financial: "#fdcb6e",
            creation: "#e17055",
            intervention: "#fd79a8",
            indirect: "#ddd",
            conflict: "#ff6b6b",
            proxy: "#e74c3c",
            economic: "#27ae60",
            industry: "#f39c12",
            supply: "#8e44ad",
            insurgency: "#e84393",
            territory: "#d63031",
            refugees: "#00cec9",
            resource: "#fdcb6e"
        };

        // Variables de control
        let currentFilter = 'all';

        // Crear simulación de fuerzas
        const simulation = d3.forceSimulation(nodes)
            .force("link", d3.forceLink(links).id(d => d.id).distance(120))
            .force("charge", d3.forceManyBody().strength(-600))
            .force("center", d3.forceCenter(width / 2, height / 2))
            .force("collision", d3.forceCollide().radius(d => d.size + 8));

        console.log("Simulación creada con", nodes.length, "nodos y", links.length, "enlaces");

        // Función para filtrar enlaces
        function getFilteredLinks() {
            return links.filter(link => {
                if (currentFilter === 'all') return true;
                if (currentFilter === 'high') return link.confidence === 'high';
                if (currentFilter === 'historical') return link.type === 'historical';
                if (currentFilter === 'current') return link.type !== 'historical';
                return true;
            });
        }

        // Crear visualización
        function createVisualization() {
            console.log("Creando visualización...");
            
            // Limpiar elementos anteriores
            g.selectAll("*").remove();
            
            const filteredLinks = getFilteredLinks();
            
            // Crear enlaces
            const link = g.selectAll(".link")
                .data(filteredLinks)
                .enter().append("line")
                .attr("class", "link")
                .attr("stroke", d => linkColors[d.type] || "#999")
                .attr("stroke-width", d => d.confidence === 'high' ? 3 : d.confidence === 'medium' ? 2 : 1)
                .attr("stroke-opacity", 0.6);

            // Crear nodos
            const node = g.selectAll(".node")
                .data(nodes)
                .enter().append("circle")
                .attr("class", "node")
                .attr("r", d => d.size)
                .attr("fill", d => nodeColors[d.type] || "#999")
                .attr("stroke", "#fff")
                .attr("stroke-width", 2)
                .on("mouseover", function(event, d) {
                    showTooltip(event, d);
                    highlightNode(d, filteredLinks);
                })
                .on("mouseout", function(event, d) {
                    hideTooltip();
                    resetHighlight();
                })
                .call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended));

            // Crear etiquetas
            const label = g.selectAll(".node-label")
                .data(nodes)
                .enter().append("text")
                .attr("class", "node-label")
                .attr("dy", 4)
                .text(d => d.name.length > 12 ? d.name.substring(0, 12) + "..." : d.name);

            // Actualizar posiciones en cada tick
            simulation.on("tick", () => {
                link
                    .attr("x1", d => d.source.x)
                    .attr("y1", d => d.source.y)
                    .attr("x2", d => d.target.x)
                    .attr("y2", d => d.target.y);

                node
                    .attr("cx", d => d.x)
                    .attr("cy", d => d.y);
                    
                label
                    .attr("x", d => d.x)
                    .attr("y", d => d.y);
            });

            // Actualizar simulación con enlaces filtrados
            simulation.force("link").links(filteredLinks);
            simulation.alpha(1).restart();
            
            console.log("Visualización creada con", filteredLinks.length, "enlaces filtrados");
        }

        // Funciones de interacción
        function showTooltip(event, d) {
            const connectedLinks = links.filter(l => 
                (l.source.id === d.id || l.target.id === d.id) || 
                (l.source === d || l.target === d)
            );
            
            let content = `<strong>${d.name}</strong><br/>`;
            content += `Tipo: ${d.type}<br/>`;
            if (d.casualties) content += `Víctimas: ${d.casualties}<br/>`;
            
            if (connectedLinks.length > 0) {
                content += `<br/><strong>Conexiones principales:</strong><br/>`;
                connectedLinks.slice(0, 4).forEach(link => {
                    const otherId = (link.source.id === d.id) ? link.target.id : 
                                   (link.target.id === d.id) ? link.source.id :
                                   (link.source === d) ? link.target.id : link.source.id;
                    const other = nodes.find(n => n.id === otherId);
                    if (other) {
                        const conf = link.confidence ? `(${link.confidence})` : '';
                        content += `→ ${other.name} ${conf}<br/>`;
                    }
                });
                if (connectedLinks.length > 4) {
                    content += `... y ${connectedLinks.length - 4} más<br/>`;
                }
            }
            
            tooltip.html(content)
                .style("left", (event.pageX + 10) + "px")
                .style("top", (event.pageY - 10) + "px")
                .style("opacity", 1);
        }

        function hideTooltip() {
            tooltip.style("opacity", 0);
        }

        function highlightNode(d, currentLinks) {
            const connectedNodeIds = new Set();
            connectedNodeIds.add(d.id);
            
            currentLinks.forEach(link => {
                if ((link.source.id === d.id || link.source === d)) {
                    connectedNodeIds.add(link.target.id || link.target);
                }
                if ((link.target.id === d.id || link.target === d)) {
                    connectedNodeIds.add(link.source.id || link.source);
                }
            });
            
            g.selectAll(".node")
                .style("opacity", n => connectedNodeIds.has(n.id) ? 1 : 0.3);
            g.selectAll(".link")
                .style("opacity", l => {
                    const sourceId = l.source.id || l.source;
                    const targetId = l.target.id || l.target;
                    return (sourceId === d.id || targetId === d.id) ? 1 : 0.1;
                });
        }

        function resetHighlight() {
            g.selectAll(".node").style("opacity", 1);
            g.selectAll(".link").style("opacity", 0.6);
        }

        // Funciones de drag
        function dragstarted(event, d) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y;
        }

        function dragged(event, d) {
            d.fx = event.x;
            d.fy = event.y;
        }

        function dragended(event, d) {
            if (!event.active) simulation.alphaTarget(0);
            d.fx = null;
            d.fy = null;
        }

        // Event listeners para controles
        document.getElementById('filterAll').addEventListener('click', function() {
            currentFilter = 'all';
            updateActiveButton(this);
            createVisualization();
        });

        document.getElementById('filterHigh').addEventListener('click', function() {
            currentFilter = 'high';
            updateActiveButton(this);
            createVisualization();
        });

        document.getElementById('filterHistorical').addEventListener('click', function() {
            currentFilter = 'historical';
            updateActiveButton(this);
            createVisualization();
        });

        document.getElementById('filterCurrent').addEventListener('click', function() {
            currentFilter = 'current';
            updateActiveButton(this);
            createVisualization();
        });

        document.getElementById('resetZoom').addEventListener('click', function() {
            svg.transition().duration(750).call(
                zoom.transform,
                d3.zoomIdentity
            );
        });

        function updateActiveButton(activeBtn) {
            document.querySelectorAll('.filters button').forEach(btn => 
                btn.classList.remove('active')
            );
            activeBtn.classList.add('active');
        }

        // Inicializar la visualización
        console.log("Inicializando visualización completa...");
        createVisualization();
        
        console.log("Script completado - Todas las conexiones cargadas");
    </script>
</body>
</html>
